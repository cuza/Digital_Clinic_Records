define(["./core","./var/document","./var/rnotwhite","./var/slice","./data/var/dataPriv","./core/init","./selector"],function(k,f,h,g,l){var j=/^key/,c=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,b=/^([^.]*)(?:\.(.+)|)/;function d(){return true}function a(){return false}function i(){try{return f.activeElement}catch(m){}}function e(r,o,m,s,q,n){var t,p;if(typeof o==="object"){if(typeof m!=="string"){s=s||m;m=undefined}for(p in o){e(r,p,m,s,o[p],n)}return r}if(s==null&&q==null){q=m;s=m=undefined}else{if(q==null){if(typeof m==="string"){q=s;s=undefined}else{q=s;s=m;m=undefined}}}if(q===false){q=a}else{if(!q){return r}}if(n===1){t=q;q=function(u){k().off(u);return t.apply(this,arguments)};q.guid=t.guid||(t.guid=k.guid++)}return r.each(function(){k.event.add(this,o,q,s,m)})}k.event={global:{},add:function(q,w,D,s,r){var o,v,u,C,B,A,y,p,z,m,n,x=l.get(q);if(!x){return}if(D.handler){o=D;D=o.handler;r=o.selector}if(!D.guid){D.guid=k.guid++}if(!(C=x.events)){C=x.events={}}if(!(v=x.handle)){v=x.handle=function(t){return typeof k!=="undefined"&&k.event.triggered!==t.type?k.event.dispatch.apply(q,arguments):undefined}}w=(w||"").match(h)||[""];B=w.length;while(B--){u=b.exec(w[B])||[];z=n=u[1];m=(u[2]||"").split(".").sort();if(!z){continue}y=k.event.special[z]||{};z=(r?y.delegateType:y.bindType)||z;y=k.event.special[z]||{};A=k.extend({type:z,origType:n,data:s,handler:D,guid:D.guid,selector:r,needsContext:r&&k.expr.match.needsContext.test(r),namespace:m.join(".")},o);if(!(p=C[z])){p=C[z]=[];p.delegateCount=0;if(!y.setup||y.setup.call(q,s,m,v)===false){if(q.addEventListener){q.addEventListener(z,v)}}}if(y.add){y.add.call(q,A);if(!A.handler.guid){A.handler.guid=D.guid}}if(r){p.splice(p.delegateCount++,0,A)}else{p.push(A)}k.event.global[z]=true}},remove:function(p,w,D,q,v){var s,r,u,C,B,A,y,o,z,m,n,x=l.hasData(p)&&l.get(p);if(!x||!(C=x.events)){return}w=(w||"").match(h)||[""];B=w.length;while(B--){u=b.exec(w[B])||[];z=n=u[1];m=(u[2]||"").split(".").sort();if(!z){for(z in C){k.event.remove(p,z+w[B],D,q,true)}continue}y=k.event.special[z]||{};z=(q?y.delegateType:y.bindType)||z;o=C[z]||[];u=u[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)");r=s=o.length;while(s--){A=o[s];if((v||n===A.origType)&&(!D||D.guid===A.guid)&&(!u||u.test(A.namespace))&&(!q||q===A.selector||q==="**"&&A.selector)){o.splice(s,1);if(A.selector){o.delegateCount--}if(y.remove){y.remove.call(p,A)}}}if(r&&!o.length){if(!y.teardown||y.teardown.call(p,m,x.handle)===false){k.removeEvent(p,z,x.handle)}delete C[z]}}if(k.isEmptyObject(C)){l.remove(p,"handle events")}},dispatch:function(m){m=k.event.fix(m);var q,p,r,n,v,u=[],t=g.call(arguments),o=(l.get(this,"events")||{})[m.type]||[],s=k.event.special[m.type]||{};t[0]=m;m.delegateTarget=this;if(s.preDispatch&&s.preDispatch.call(this,m)===false){return}u=k.event.handlers.call(this,m,o);q=0;while((n=u[q++])&&!m.isPropagationStopped()){m.currentTarget=n.elem;p=0;while((v=n.handlers[p++])&&!m.isImmediatePropagationStopped()){if(!m.rnamespace||m.rnamespace.test(v.namespace)){m.handleObj=v;m.data=v.data;r=((k.event.special[v.origType]||{}).handle||v.handler).apply(n.elem,t);if(r!==undefined){if((m.result=r)===false){m.preventDefault();m.stopPropagation()}}}}}if(s.postDispatch){s.postDispatch.call(this,m)}return m.result},handlers:function(m,o){var q,r,n,t,s=[],p=o.delegateCount,u=m.target;if(p&&u.nodeType&&(m.type!=="click"||isNaN(m.button)||m.button<1)){for(;u!==this;u=u.parentNode||this){if(u.nodeType===1&&(u.disabled!==true||m.type!=="click")){r=[];for(q=0;q<p;q++){t=o[q];n=t.selector+" ";if(r[n]===undefined){r[n]=t.needsContext?k(n,this).index(u)>-1:k.find(n,this,null,[u]).length}if(r[n]){r.push(t)}}if(r.length){s.push({elem:u,handlers:r})}}}}if(p<o.length){s.push({elem:this,handlers:o.slice(p)})}return s},props:("altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which").split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(n,m){if(n.which==null){n.which=m.charCode!=null?m.charCode:m.keyCode}return n}},mouseHooks:{props:("button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement").split(" "),filter:function(p,o){var q,r,m,n=o.button;if(p.pageX==null&&o.clientX!=null){q=p.target.ownerDocument||f;r=q.documentElement;m=q.body;p.pageX=o.clientX+(r&&r.scrollLeft||m&&m.scrollLeft||0)-(r&&r.clientLeft||m&&m.clientLeft||0);p.pageY=o.clientY+(r&&r.scrollTop||m&&m.scrollTop||0)-(r&&r.clientTop||m&&m.clientTop||0)}if(!p.which&&n!==undefined){p.which=(n&1?1:(n&2?3:(n&4?2:0)))}return p}},fix:function(p){if(p[k.expando]){return p}var n,s,r,o=p.type,m=p,q=this.fixHooks[o];if(!q){this.fixHooks[o]=q=c.test(o)?this.mouseHooks:j.test(o)?this.keyHooks:{}}r=q.props?this.props.concat(q.props):this.props;p=new k.Event(m);n=r.length;while(n--){s=r[n];p[s]=m[s]}if(!p.target){p.target=f}if(p.target.nodeType===3){p.target=p.target.parentNode}return q.filter?q.filter(p,m):p},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==i()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===i()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&k.nodeName(this,"input")){this.click();return false}},_default:function(m){return k.nodeName(m.target,"a")}},beforeunload:{postDispatch:function(m){if(m.result!==undefined&&m.originalEvent){m.originalEvent.returnValue=m.result}}}}};k.removeEvent=function(n,m,o){if(n.removeEventListener){n.removeEventListener(m,o)}};k.Event=function(n,m){if(!(this instanceof k.Event)){return new k.Event(n,m)}if(n&&n.type){this.originalEvent=n;this.type=n.type;this.isDefaultPrevented=n.defaultPrevented||n.defaultPrevented===undefined&&n.returnValue===false?d:a}else{this.type=n}if(m){k.extend(this,m)}this.timeStamp=n&&n.timeStamp||k.now();this[k.expando]=true};k.Event.prototype={constructor:k.Event,isDefaultPrevented:a,isPropagationStopped:a,isImmediatePropagationStopped:a,preventDefault:function(){var m=this.originalEvent;this.isDefaultPrevented=d;if(m){m.preventDefault()}},stopPropagation:function(){var m=this.originalEvent;this.isPropagationStopped=d;if(m){m.stopPropagation()}},stopImmediatePropagation:function(){var m=this.originalEvent;this.isImmediatePropagationStopped=d;if(m){m.stopImmediatePropagation()}this.stopPropagation()}};k.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(n,m){k.event.special[n]={delegateType:m,bindType:m,handle:function(q){var o,s=this,r=q.relatedTarget,p=q.handleObj;if(!r||(r!==s&&!k.contains(s,r))){q.type=p.origType;o=p.handler.apply(this,arguments);q.type=m}return o}}});k.fn.extend({on:function(n,m,p,o){return e(this,n,m,p,o)},one:function(n,m,p,o){return e(this,n,m,p,o,1)},off:function(o,m,q){var n,p;if(o&&o.preventDefault&&o.handleObj){n=o.handleObj;k(o.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler);return this}if(typeof o==="object"){for(p in o){this.off(p,m,o[p])}return this}if(m===false||typeof m==="function"){q=m;m=undefined}if(q===false){q=a}return this.each(function(){k.event.remove(this,o,q,m)})}});return k});