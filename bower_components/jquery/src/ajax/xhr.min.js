define(["../core","../var/support","../ajax"],function(c,b){c.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest()}catch(f){}};var a={0:200,1223:204},d=c.ajaxSettings.xhr();b.cors=!!d&&("withCredentials" in d);b.ajax=d=!!d;c.ajaxTransport(function(f){var g,e;if(b.cors||d&&!f.crossDomain){return{send:function(m,h){var j,l=f.xhr();l.open(f.type,f.url,f.async,f.username,f.password);if(f.xhrFields){for(j in f.xhrFields){l[j]=f.xhrFields[j]}}if(f.mimeType&&l.overrideMimeType){l.overrideMimeType(f.mimeType)}if(!f.crossDomain&&!m["X-Requested-With"]){m["X-Requested-With"]="XMLHttpRequest"}for(j in m){l.setRequestHeader(j,m[j])}g=function(i){return function(){if(g){g=e=l.onload=l.onerror=l.onabort=l.onreadystatechange=null;if(i==="abort"){l.abort()}else{if(i==="error"){if(typeof l.status!=="number"){h(0,"error")}else{h(l.status,l.statusText)}}else{h(a[l.status]||l.status,l.statusText,(l.responseType||"text")!=="text"||typeof l.responseText!=="string"?{binary:l.response}:{text:l.responseText},l.getAllResponseHeaders())}}}}};l.onload=g();e=l.onerror=g("error");if(l.onabort!==undefined){l.onabort=e}else{l.onreadystatechange=function(){if(l.readyState===4){window.setTimeout(function(){if(g){e()}})}}}g=g("abort");try{l.send(f.hasContent&&f.data||null)}catch(k){if(g){throw k}}},abort:function(){if(g){g()}}}}})});